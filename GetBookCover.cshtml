@{
    if (!WebSecurity.IsAuthenticated)
    {
        Response.Redirect("~/LoginPage?returnUrl="
            + Request.Url.LocalPath);
    }

    var id = Request["id"];
    if (id != null && id.Any())
    {
        var files = Directory.GetFiles(Server.MapPath("~/uploads/"));
        var file = files.FirstOrDefault(x => x.Contains("cover-" + id));
        if (file != null)
        {
            var data = File.ReadAllBytes(file);
            var encoded = Convert.ToBase64String(data);
            Response.Write(encoded);
        }
        else
        {
            Response.Write("File not found");
        }
    }
}
